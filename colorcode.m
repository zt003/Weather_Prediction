function [RGB,EC]=colorcode(C)
%COLORCODE Returns an RGB vector based on a color name. 
%   RGB = COLORCODE(C) returns an RGB vector based on the color name
%   contained in string C. If C contains a numeric string with integer
%   number N then the RGB vector contains the Nth color in the color
%   order of the current axis system. Parameter C may also be one of the
%   following:  
%               'black'    'buckgray'
%               'white'    'bucksilver'
%               'red'      'buckred'
%               'green'    'buckgreen'
%               'blue'     'buckblue'
%               'yellow'   'buckyellow'
%               'magenta'  'buckmagenta'
%               'cyan'     'buckcyan'
%               'olive'    'buckbrown' 
%               'violet'   'buckburgundy'
%               'orange'   'buckorange'
%               'aqua'     'gray'
%               'gray-'    'gray--'
%               'gray+'    'gray++'
%   
%   [RGB,EC] = COLORCODE(C) also returns an error code EC of one if the
%   string in C does not refer to a valid color definition. Parameter EC 
%   is zero otherwise.
%.  Copyright (c) 2017 by Robert M. Nickel
%   $Revision: 1.0 $
%   $Date: 02-Nov-2017 $

% define a default RGB vector
RGB=[0 0 0]; EC=1;

% check for the color order case
N=str2double(C); if ~isnan(N);
    % format the number
    N=real(round(N));
    % get the color order matrix and the index into the matrix
    CO=get(gca,'ColorOrder'); M=size(CO,1); N=mod(N-1,M)+1;
    % get the RGB vector
    RGB=CO(N,:); EC=0;
    % end the function
    return
end

% define a list with all predefined colors
CA={...
 'black',       [0,0,0];...
 'white',       [1,1,1];...
 'red',         [1,0,0];...
 'green',       [0,1,0];...
 'blue',        [0,0,1];...
 'yellow',      [1,1,0];...
 'magenta',     [1,0,1];...
 'cyan',        [0,1,1];...
 'olive',       [0,2,0]/4;...
 'aqua',        [0,2,2]/4;...
 'violet',      [2,0,2]/4;...
 'orange',      [4,2,0]/4;...
 'buckblue',    [0.12891,0.23438,0.41016];...
 'buckbrown',   [0.625,0.51172,0.14844];...
 'buckburgundy',[0.45312,0.023438,0.0078125];...
 'buckcyan',    [0,0.5625,0.71875];...
 'buckgray',    [0.92188,0.92188,0.92188];...
 'buckgreen',   [0,0.36719,0.17188];...
 'buckmagenta', [0.33594,0.09375,0.33984];...
 'buckorange',  [0.94531,0.67969,0.21094];...
 'buckred',     [0.62109,0.097656,0.14844];...
 'bucksilver',  [0.71094,0.77734,0.79688];...
 'buckyellow',  [0.99219,0.78906,0.23828];...
 'gray',        0.5*[1,1,1];...
 'gray-',       0.7*[1,1,1];...
 'gray--',      0.9*[1,1,1];...
 'gray+',       0.3*[1,1,1];...
 'gray++',      0.1*[1,1,1] ...
};

% check if the color code is in the list from above
idx=strmatch(lower(C),CA(:,1)); if ~isempty(idx);
    % assign the found color code
    RGB=CA{idx(1),2}; EC=0;
    % end the function
    return
end


